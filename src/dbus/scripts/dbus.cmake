include (OS)

if (UNIX)
# find_package (DBus1 MODULE)
 find_package (DBus1)
 if (NOT DBus1_FOUND)
  include (FindPkgConfig)
  pkg_check_modules (PKG_DBUS dbus-1)
  if (NOT PKG_DBUS_FOUND)
   find_library (DBUS_LIBRARY libdbus-1.so
                 PATHS /usr/lib64
                 DOC "searching for libdbus-1")
   if (NOT DBUS_LIBRARY)
    message (WARNING "could not find libdbus-1, continuing")
   else ()
    message (STATUS "found dbus-1")
    set (DBUS1_FOUND TRUE)
    set (DBus1_INCLUDE_DIRS "")
    set (DBus1_LIBRARIES "${DBUS_LIBRARY}")
   endif (NOT DBUS_LIBRARY)
  else ()
   message (STATUS "found dbus-1")
   set (DBUS1_FOUND TRUE)
   set (DBus1_INCLUDE_DIRS "${PKG_DBUS_INCLUDE_DIRS}")
   set (DBus1_LIBRARIES "${PKG_DBUS_LIBRARIES}")
  endif (NOT PKG_DBUS_FOUND)
 else ()
  set (DBUS1_FOUND TRUE)
  if (CMAKE_SYSTEM_NAME MATCHES "Linux")
   if (${LSB_RELEASE_ID_SHORT} MATCHES "Fedora")
#*NOTE*: add a missing directory (Fedora 34)
    set (DBus1_INCLUDE_DIRS "${DBus1_INCLUDE_DIRS};/usr/lib64/dbus-1.0/include")
   endif (${LSB_RELEASE_ID_SHORT} MATCHES "Fedora")
  endif (CMAKE_SYSTEM_NAME MATCHES "Linux")
 endif (NOT DBus1_FOUND)
 if (DBUS1_FOUND)
  message (STATUS "found DBus1")
  option (DBUS_SUPPORT "enable dbus support" ON)
  if (DBUS_SUPPORT)
   add_definitions (-DDBUS_SUPPORT)
  endif (DBUS_SUPPORT)
 endif (DBUS1_FOUND)
endif (UNIX)
